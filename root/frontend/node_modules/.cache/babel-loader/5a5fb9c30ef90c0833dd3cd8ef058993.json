{"ast":null,"code":"import _objectSpread from\"C:/Users/rydwan/Desktop/snakeTS/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/rydwan/Desktop/snakeTS/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable @typescript-eslint/no-unused-vars */ /* eslint-disable react-hooks/exhaustive-deps */import{useEffect,useState,useRef}from\"react\";import useGameLogic from\"./useGameLogic\";export default function useGame(render){var requestID=useRef(null);var previousTime=useRef(null);var gameLogic=useGameLogic();var _useState=useState(gameLogic.gameDataRef.current),_useState2=_slicedToArray(_useState,2),gameData=_useState2[0],setGameData=_useState2[1];var newFrameRef=useRef(-1);function loop(time){var speed=gameData.speed;if(time>newFrameRef.current){newFrameRef.current=time+speed;gameLogic.update();}setGameData(_objectSpread({},gameLogic.gameDataRef.current));previousTime.current=time;requestID.current=requestAnimationFrame(loop);}useEffect(function(){render();},[gameData]);useEffect(function(){console.log(\"renderUseGame\");requestID.current=requestAnimationFrame(loop);return function(){return cancelAnimationFrame(requestID.current);};},[]);return _objectSpread(_objectSpread({},gameLogic),{},{gameData:gameData});}","map":{"version":3,"names":["useEffect","useState","useRef","useGameLogic","useGame","render","requestID","previousTime","gameLogic","gameDataRef","current","gameData","setGameData","newFrameRef","loop","time","speed","update","requestAnimationFrame","console","log","cancelAnimationFrame"],"sources":["C:/Users/rydwan/Desktop/snakeTS/src/components/GameSite/useGame.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\r\n/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useEffect, useState, useRef } from \"react\";\r\nimport useGameLogic from \"./useGameLogic\";\r\n\r\nexport default function useGame(render: () => void) {\r\n  const requestID = useRef<number | null>(null);\r\n  const previousTime = useRef<number | null>(null);\r\n\r\n  const gameLogic = useGameLogic();\r\n\r\n  const [gameData, setGameData] = useState(gameLogic.gameDataRef.current);\r\n\r\n  const newFrameRef = useRef(-1);\r\n\r\n  function loop(time: number) {\r\n    const speed = gameData.speed;\r\n    if (time > newFrameRef.current) {\r\n      newFrameRef.current = time + speed;\r\n      gameLogic.update();\r\n    }\r\n\r\n    setGameData({ ...gameLogic.gameDataRef.current });\r\n    previousTime.current = time;\r\n\r\n    requestID.current! = requestAnimationFrame(loop);\r\n  }\r\n\r\n  useEffect(() => {\r\n    render();\r\n  }, [gameData]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"renderUseGame\");\r\n\r\n    requestID.current = requestAnimationFrame(loop);\r\n\r\n    return () => cancelAnimationFrame(requestID.current!);\r\n  }, []);\r\n  return { ...gameLogic, gameData };\r\n}\r\n"],"mappings":"yOAAA,sD,CACA,gDACA,OAAgBA,SAAhB,CAA2BC,QAA3B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,MAAOC,aAAP,KAAyB,gBAAzB,CAEA,cAAe,SAASC,QAAT,CAAiBC,MAAjB,CAAqC,CAClD,GAAMC,UAAS,CAAGJ,MAAM,CAAgB,IAAhB,CAAxB,CACA,GAAMK,aAAY,CAAGL,MAAM,CAAgB,IAAhB,CAA3B,CAEA,GAAMM,UAAS,CAAGL,YAAY,EAA9B,CAEA,cAAgCF,QAAQ,CAACO,SAAS,CAACC,WAAV,CAAsBC,OAAvB,CAAxC,wCAAOC,QAAP,eAAiBC,WAAjB,eAEA,GAAMC,YAAW,CAAGX,MAAM,CAAC,CAAC,CAAF,CAA1B,CAEA,QAASY,KAAT,CAAcC,IAAd,CAA4B,CAC1B,GAAMC,MAAK,CAAGL,QAAQ,CAACK,KAAvB,CACA,GAAID,IAAI,CAAGF,WAAW,CAACH,OAAvB,CAAgC,CAC9BG,WAAW,CAACH,OAAZ,CAAsBK,IAAI,CAAGC,KAA7B,CACAR,SAAS,CAACS,MAAV,GACD,CAEDL,WAAW,kBAAMJ,SAAS,CAACC,WAAV,CAAsBC,OAA5B,EAAX,CACAH,YAAY,CAACG,OAAb,CAAuBK,IAAvB,CAEAT,SAAS,CAACI,OAAV,CAAqBQ,qBAAqB,CAACJ,IAAD,CAA1C,CACD,CAEDd,SAAS,CAAC,UAAM,CACdK,MAAM,GACP,CAFQ,CAEN,CAACM,QAAD,CAFM,CAAT,CAIAX,SAAS,CAAC,UAAM,CACdmB,OAAO,CAACC,GAAR,CAAY,eAAZ,EAEAd,SAAS,CAACI,OAAV,CAAoBQ,qBAAqB,CAACJ,IAAD,CAAzC,CAEA,MAAO,kBAAMO,qBAAoB,CAACf,SAAS,CAACI,OAAX,CAA1B,EAAP,CACD,CANQ,CAMN,EANM,CAAT,CAOA,sCAAYF,SAAZ,MAAuBG,QAAQ,CAARA,QAAvB,GACD"},"metadata":{},"sourceType":"module"}